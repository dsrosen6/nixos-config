################ Common Variables #################
$scripts = ~/.config/scripts
$hyprScripts = ~/.config/hypr/scripts
$rofiScript = $HOME/.config/rofi/rofi.sh
$menu = $rofiScript

$left = h
$down = j
$up = k
$right = l

###################### Apps #######################
$terminal = uwsm-app -- ghostty
$browser = uwsm-app -- firefox
$fileMgr = uwsm-app -- nautilus
$fileMgrAlt = uwsm-app -- ghostty -e yazi
$music = uwsm-app -- spotify
$passwords = 1password --quick-access # works sometimes
$obsidian = uwsm-app -- obsidian

#################### Utilities ####################
$screenshot = grim -g "$(slurp)" - | swappy -f -
$toggleWaybar = $scripts/waybar-toggle.sh

# Workspace/Tiling
$toggleFloat = $hyprScripts/float.sh
$openScratch = [workspace special:S]

# Menus/OSD/Misc
$nixCfg = uwsm-app -- ghostty -e sh -c "cd ~/nixos && nvim home-manager/home.nix"
$power = $rofiScript power
$clipboardMenu = $rofiScript clipboard
$volDown = swayosd-client --output-volume lower
$volUp = swayosd-client --output-volume raise
$customMsg = swayosd-client --custom-message


################# Mouse/Gestures ##################
gesture = 4, horizontal, workspace
gesture = 3, swipe, resize
gesture = 4, vertical, close

bindm = SUPER, mouse:272, movewindow
bindm = SUPER, mouse:273, resizewindow
bind = SUPERCTRL, mouse_down, changegroupactive, f
bind = SUPERCTRL, mouse_up, changegroupactive, b
bind = SUPER, mouse_down, workspace, e-1
bind = SUPER, mouse_up, workspace, e+1
bindm = , mouse:277, resizewindow # MX Master thumb button

##################### System ######################
bind = SUPERSHIFT, P, exec, $power
bind = SUPER, P, exec, $toggleWaybar
bind = SUPER, C, exec, $clipboardMenu
bind = CTRLSHIFT, L, exec, loginctl lock-session
bind = CTRLSHIFT, Y, exec, swaync-client -t

################## Apps/Utilities #################
bind = SUPER, Return, exec, $terminal
bind = SUPERSHIFT, Return, exec, $terminal --title=float-term # floating, scratchpad terminal
bind = SUPER, B, exec, $browser
bind = SUPER, E, exec, $fileMgr
bind = SUPER, Y, exec, $fileMgrAlt
bind = SUPER, N, exec, $nixCfg
bind = SUPER, O, exec, $obsidian
bind = CTRL, SPACE, exec, $menu
bind = CTRLSHIFT, SPACE, exec, $passwords
bind = CTRLSHIFT, 4, exec, $screenshot

############### Tiling / Workspaces ###############
bind = SUPER, Q, killactive
bind = SUPER, Tab, togglegroup 
bind = SUPER, T, layoutmsg, togglesplit
bind = SUPER, $left, movefocus, l
bind = SUPER, $down, movefocus, d
bind = SUPER, $up, movefocus, u
bind = SUPER, $right, movefocus, r
bind = SUPERSHIFT, $left, movewindoworgroup, l
bind = SUPERSHIFT, $down, movewindoworgroup, d
bind = SUPERSHIFT, $up, movewindoworgroup, u
bind = SUPERSHIFT, $right, movewindoworgroup, r
bind = SUPER, bracketleft, changegroupactive, b
bind = SUPER, bracketright, changegroupactive, f
bind = SUPERCTRL, $left, changegroupactive, b
bind = SUPERCTRL, $right, changegroupactive, f
bind = SUPERCTRL, D, denywindowfromgroup, toggle
bind = SUPER, W, swapsplit
bind = SUPER, F, exec, $toggleFloat

bind = SUPER, 1, workspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER, 6, workspace, 6
bind = SUPER, 7, workspace, 7
bind = SUPER, 8, workspace, 8
bind = SUPER, 9, workspace, 9
bind = SUPER, 0, workspace, 10

bind = SUPERSHIFT, 1, movetoworkspace, 1
bind = SUPERSHIFT, 2, movetoworkspace, 2
bind = SUPERSHIFT, 3, movetoworkspace, 3
bind = SUPERSHIFT, 4, movetoworkspace, 4
bind = SUPERSHIFT, 5, movetoworkspace, 5
bind = SUPERSHIFT, 6, movetoworkspace, 6
bind = SUPERSHIFT, 7, movetoworkspace, 7
bind = SUPERSHIFT, 8, movetoworkspace, 8
bind = SUPERSHIFT, 9, movetoworkspace, 9
bind = SUPERSHIFT, 0, movetoworkspace, 10

bind = SUPER, S, togglespecialworkspace, S # scratchpad
bind = SUPERSHIFT, S, movetoworkspace, special:S

################## Multimedia Keys ###############
bindel = SUPER, XF86AudioLowerVolume, resizeactive, -50 0
bindel = SUPER, XF86AudioRaiseVolume, resizeactive, 50 0 
bindel = ,XF86AudioLowerVolume, exec, $volDown
bindel = ,XF86AudioRaiseVolume, exec, $volUp
bindel = ,XF86AudioLowerVolume, exec, $volDown
bindel = ,XF86AudioMute, exec, swayosd-client --output-volume mute-toggle
bindel = ,XF86AudioMicMute, exec, swayosd-client --input-volume mute-toggle
bindel = ,XF86MonBrightnessUp, exec, swayosd-client --brightness raise
bindel = ,XF86MonBrightnessDown, exec, swayosd-client --brightness lower
bindl = , XF86Search, exec, $menu
bindl = , XF86AudioPlay, exec, swayosd-client --playerctl play-pause
bindl = , XF86AudioNext, exec, swayosd-client --playerctl next
bindl = , XF86AudioPrev, exec, swayosd-client --playerctl previous

#################### SUBMAPS ####################
$setMap = $hyprScripts/set_submap.sh
$setResizeMap = $setMap RS "Resize"
$setMoveMap = $setMap MV "Move"
$setMediaMap = $setMap MD "Media"
$exitMap =  $setMap reset
bind = SUPER, semicolon, exec, $setResizeMap
bind = SUPER, M, exec, $setMediaMap

submap = RS # Resize
    bind = , M, exec, $setMediaMap
    bind = , Escape, exec, $exitMap
    bind = , semicolon, exec, $setMoveMap
    bind = , F, exec, $toggleFloat
    bind = , T, layoutmsg, togglesplit
    # use volume knob to resize active window
    bindel = , XF86AudioLowerVolume, resizeactive, -50 0
    bindel = , XF86AudioRaiseVolume, resizeactive, 50 0 
    binde = , H, resizeactive, -50 0
    binde = , J, resizeactive, 0 30
    binde = , K, resizeactive, 0 -30
    binde = , L, resizeactive, 50 0
    binde = SHIFT, H, resizeactive, -125 0 # big mode
    binde = SHIFT, L, resizeactive, 125 0
    submap = reset

submap = MV # Move
    bind = , M, exec, $setMediaMap
    bind = , Escape, exec, $exitMap
    bind = , semicolon, exec, $setResizeMap
    bind = , F, exec, $toggleFloat
    bind = , T, layoutmsg, togglesplit
    binde = , H, moveactive, -125 0
    binde = , J, moveactive, 0 75
    binde = , K, moveactive, 0 -75
    binde = , L, moveactive, 125 0
    binde = SHIFT, H, movewindoworgroup, l
    binde = SHIFT, J, movewindoworgroup, d
    binde = SHIFT, K, movewindoworgroup, u
    binde = SHIFT, L, movewindoworgroup, r
    submap = reset

submap = MD # Media
    bind = , semicolon, exec, $setResizeMap
    bind = , Escape, exec, $exitMap
    bind = , S, exec, $music
    bind = , S, exec, $exitMap
    bindel = , H, exec, swayosd-client --brightness lower
    bindel = , J, exec, $volDown 
    bindel = , K, exec, $volUp 
    bindel = , L, exec, swayosd-client --brightness raise
    bindl  = , M, exec, swayosd-client --output-volume mute-toggle
    bindl  = , SPACE, exec, swayosd-client --playerctl play-pause
    bindl  = SHIFT, N, exec, swayosd-client --playerctl previous
    bindl  = , N, exec, swayosd-client --playerctl next
    submap = reset
